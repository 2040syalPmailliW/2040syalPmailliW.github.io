<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPS tester</title>
    <script src="./index.js" defer></script>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <link rel="stylesheet" href="./index.css">
</head>
<body>
  <!-- <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script> -->
  <script defer>
    var letIn = false;
    var map = new Map(); // You could also use an array
    onkeydown = onkeyup = function(e){
        e = e || event; // to deal with IE
        map.set(e.keyCode, e.type == 'keydown');
        console.log()
    }
    setTimeout(async () => {
        let count = 0;
        map.forEach(e => {
            if (e) {
                count++
            }
        });
        if (count == 4) {
          console.log("Allowed!")
          letIn = true;
        }
    }, 500);
    async function getIpClient() {
    try {
        const response = await fetch('https://api.ipify.org?format=json')
        // const response = await axios.get('https://api.ipify.org?format=json');
        return response.json();
    } catch (error) {
        console.error(error);
    }
    }
    async function seeifschool(blockIP) {
        var ip = await getIpClient();
        console.log(ip.ip)
        if ( ip.ip == blockIP ) {
            console.log('Wrong ip!')
            setTimeout(() => {
              if (!letIn) {
                let elements = document.querySelector(".all");
                elements = Array.from(elements.children);

                elements.forEach(e => {
                    e.style.display = "none"

                });
                // elements = document.querySelectorAll("booster");

                // elements.forEach(e => {
                //     e.remove();
                // });
              }
            }, 1000);
            
            var ele = document.createElement("h1");
            ele.innerHTML = "Not allowed! This CPS tester is not allowed in school. Sorry!";
            ele.style.color = "red";
            document.body.appendChild(ele);
        } else {
            console.log('Not school ip!')
        }
    }
    seeifschool("80.146.244.202")
    </script>
    <h1>Free, simple CPS tester.</h1>
    <div class="all">
        <div class="booster" id="booster">CPS BOOSTER ACTIVATED (1.5x cps)</div>
        <div class="container">
            <button id="button">Click to see your cps!</button>
            <div>Current CPS:</div><div id="cps" class="count">0</div>
            <div>Max CPS:</div><div id="maxCPS" class="count">0</div>
        </div>
        <a href="https://github.com/WilliamPlays0402"><img src="https://github-readme-stats.vercel.app/api?username=WilliamPlays0402&show_icons=true&theme=synthwave"></a>
        <form action="?" method="POST">
            <div class="g-recaptcha" data-sitekey="6Lf2XSwiAAAAAE7fDOz3KAJWTgjSFsiQnPcJblM8"></div>
            <br/>
            <input type="submit" value="Submit">
        </form>
    </div>
    <script>
document.onkeydown = function(e) {
if(event.keyCode == 123) {
return false;
}
if(e.ctrlKey && e.keyCode == 'E'.charCodeAt(0)){
return false;
}
if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)){
return false;
}
if(e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)){
return false;
}
if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)){
return false;
}
if(e.ctrlKey && e.keyCode == 'S'.charCodeAt(0)){
return false;
}
if(e.ctrlKey && e.keyCode == 'H'.charCodeAt(0)){
return false;
}
if(e.ctrlKey && e.keyCode == 'A'.charCodeAt(0)){
return false;
}
if(e.ctrlKey && e.keyCode == 'F'.charCodeAt(0)){
return false;
}
if(e.ctrlKey && e.keyCode == 'E'.charCodeAt(0)){
return false;
}
}
</script>
</body>
</html>
